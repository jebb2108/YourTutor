<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мой словарь</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 500px;
            margin: 0 auto;
        }
        .word {
            font-size: 2em;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .pos {
            font-style: italic;
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        .translation {
            font-size: 1.2em;
            color: #27ae60;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
        }
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="card">
        <div class="word" id="word">Загрузка...</div>
        <div class="pos" id="pos"></div>
        <div class="translation" id="translation"></div>
        <div class="navigation">
            <button id="prev-btn">← Предыдущее</button>
            <button id="next-btn">Следующее →</button>
        </div>
        <div class="counter" id="counter"></div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let words = [];
        let currentIndex = 0;

        // Получение данных словаря
        async function fetchWords() {
            try {
                const userId = tg.initDataUnsafe.user.id;
                const response = await fetch(`https://ваш-бэкенд.домен/api/words?user_id=${userId}`);

                if (!response.ok) {
                    throw new Error('Ошибка загрузки слов');
                }

                words = await response.json();

                if (words.length > 0) {
                    renderWord(0);
                } else {
                    showEmptyState();
                }
            } catch (error) {
                console.error('Ошибка:', error);
                document.getElementById('word').textContent = 'Ошибка загрузки словаря';
            }
        }

        // Отображение слова
        function renderWord(index) {
            const word = words[index];
            document.getElementById('word').textContent = word.word;
            document.getElementById('pos').textContent = word.part_of_speech;
            document.getElementById('translation').textContent = word.translation || 'Нет перевода';
            document.getElementById('counter').textContent = `${index + 1} из ${words.length}`;

            document.getElementById('prev-btn').disabled = index === 0;
            document.getElementById('next-btn').disabled = index === words.length - 1;
        }

        // Показ состояния пустого словаря
        function showEmptyState() {
            document.getElementById('word').textContent = 'Словарь пуст';
            document.getElementById('pos').textContent = '';
            document.getElementById('translation').textContent = 'Добавьте слова через бота';
            document.getElementById('counter').textContent = '';
            document.getElementById('prev-btn').disabled = true;
            document.getElementById('next-btn').disabled = true;
        }

        // Обработчики кнопок
        document.getElementById('prev-btn').addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                renderWord(currentIndex);
            }
        });

        document.getElementById('next-btn').addEventListener('click', () => {
            if (currentIndex < words.length - 1) {
                currentIndex++;
                renderWord(currentIndex);
            }
        });

        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', fetchWords);
    </script>
</body>
</html>